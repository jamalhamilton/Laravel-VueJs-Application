webpackJsonp([1],{"0tw1":function(t,e){},"47xX":function(t,e){},"9BHd":function(t,e){},DRjT:function(t,e){},E4tw:function(t,e){},Jr11:function(t,e){},N7k7:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("7+uW"),o=i("Dd8w"),n=i.n(o),c=i("d7EF"),a=i.n(c),s=i("Gu7T"),d=i.n(s),u=i("mtWM"),l=i.n(u),h=new MicRecorder({bitRate:128}),v={name:"Record",props:{choir:{required:!0},recordings:{required:!1}},data:function(){return{unsavedRecordings:[],isUploading:!1}},computed:{filteredRecordings:function(){var t=this;return[].concat(d()(this.recordings),d()(this.unsavedRecordings)).filter(function(e){return e.choir_id===t.choir.id})}},methods:{toggleRecording:function(){var t=this;this.choir.isRecording?(this.$emit("stop-recording"),h.stop().getMp3().then(function(e){var i=a()(e,2),r=i[0],o=i[1],n=new File(r,"music.mp3",{type:o.type,lastModified:Date.now()}),c=(window.URL||window.webkitURL).createObjectURL(o),s=new Date,d=s.getUTCFullYear()+"-"+(s.getUTCMonth()+1)+"-"+s.getUTCDate()+" "+s.getUTCHours()+":"+s.getUTCMinutes()+":"+s.getUTCSeconds();t.unsavedRecordings.push({choir_id:t.choir.id,url:c,created_at:d,isUnsaved:!0});var u=new FormData;u.append("division_id",t.choir.division_id),u.append("round_id",t.choir.round_id),u.append("file",n),u.append("file_name",n),u.append("choir_id",t.choir.id),t.uploadFile(u,t.unsavedRecordings.length-1)}).catch(function(t){console.error(t)})):h.start().then(function(){t.$emit("start-recording")}).catch(function(t){return console.log(t),"NotFoundError"===t.name?alert("Please plugin your microphone"):"TypeError"===t.name?alert("Your browser does not support recording"):alert("Something went wrong"),!1})},uploadFile:function(t,e){var i=this;console.log(t),this.isUploading=!0,l.a.post("/judge/recording/save",t).then(function(t){console.log("response",t),void 0!==t.statusText&&"Created"===t.statusText?i.unsavedRecordings[e].isUnsaved=!1:(i.$emit("upload-error"),i.unsavedRecordings[e].isUnsaved=!0)},function(t){console.log("response",t),i.$emit("upload-error"),i.unsavedRecordings[e].isUnsaved=!0}).finally(function(){i.$emit("upload-complete"),i.isUploading=!1})}}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("button",{staticClass:"button",class:{cancel:t.choir.isDisabled},attrs:{disabled:t.choir.isDisabled},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.toggleRecording()}}},[i("span",{directives:[{name:"show",rawName:"v-show",value:!t.choir.isRecording,expression:"!choir.isRecording"}]},[t._v("Start Recording")]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.choir.isRecording,expression:"choir.isRecording"}]},[t._v("Stop Recording")])]),t._v(" "),i("ul",{ref:"recList",staticClass:"list-container"},[t._l(t.filteredRecordings,function(e,r){return[i("li",{key:r,staticClass:"record-row"},[i("span",{staticClass:"record-span"},[t._v(t._s(r+1)+".")]),t._v(" "),i("div",{staticClass:"record-item-audio"},[i("audio",{staticClass:"record-item",attrs:{controls:""}},[i("source",{attrs:{src:e.url,controls:"true"}})]),t._v(" "),i("span",[i("a",{attrs:{href:e.url,download:e.created_at+".mp3"}},[t._v(t._s(e.created_at)+".mp3 (UTC)")])]),t._v(" "),e.isUnsaved&&t.isUploading?i("div",{staticClass:"slider"},[i("div",{staticClass:"line"}),t._v(" "),i("div",{staticClass:"subline inc"}),t._v(" "),i("div",{staticClass:"subline dec"})]):t._e()])])]})],2)])},staticRenderFns:[]};var _=i("VU/8")(v,m,!1,function(t){i("47xX")},"data-v-31aea48a",null).exports,p=i("KvPw"),f=i.n(p),g=(i("9BHd"),{name:"DropZone",components:{vue2Dropzone:f.a},props:{choir:{required:!0}},data:function(){return{dropzoneOptions:{url:window.origin+"/judge/recording/save",acceptedFiles:"audio/*",addRemoveLinks:!0,maxFilesize:500,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="_token"]').getAttribute("content")}}}},methods:{uploadprogress:function(t){this.$emit("upload-start")},uploadFile:function(t,e,i){i.append("division_id",this.choir.division_id),i.append("round_id",this.choir.round_id),i.append("choir_id",this.choir.id)},success:function(t,e){void 0!==e&&void 0!==e.url||(console.log(e),this.$emit("upload-error"))},complete:function(t,e){this.$emit("upload-complete")},error:function(t,e,i){console.log(e),console.log(i),this.$emit("upload-error")}},beforeDestroy:function(){this.$refs.dropzone.removeAllFiles(!0)}}),C={render:function(){var t=this.$createElement;return(this._self._c||t)("vue2-dropzone",{ref:"dropzone",attrs:{options:this.dropzoneOptions},on:{"vdropzone-sending":this.uploadFile,"vdropzone-file-added":this.uploadprogress,"vdropzone-success":this.success,"vdropzone-complete":this.complete,"vdropzone-error":this.error}})},staticRenderFns:[]},S={name:"Spreadsheet",components:{Record:_,DropZone:i("VU/8")(g,C,!1,null,null,null).exports},data:function(){return{activeChoir:null,activeCriterion:null,audioRecorder:null,recordingData:[],currentRecordingId:null}},computed:{captionWeightingId:function(){return this.$store.getters.captionWeightingId},choirsList:function(){var t=this;return this.$store.getters.getChoirsList.map(function(e){return n()({},e,{isRecording:e.id===t.currentRecordingId,isDisabled:t.currentRecordingId&&t.currentRecordingId!==e.id})})},captionsList:function(){return this.$store.state.captionsList},criteriaList:function(){return this.$store.state.criteriaList},scores:function(){return this.$store.state.scores},ratings:function(){return this.$store.state.ratings},hasRatings:function(){return 0!==this.$store.state.ratings.length},hasPremium:function(){return this.$store.state.competition.is_premium},activeModal:function(){return this.$store.state.activeModal},isSpreadsheetScoringActive:function(){return this.$store.state.isSpreadsheetScoringActive},division:function(){return this.$store.state.divisions},recordings:function(){return this.$store.state.recordings}},watch:{activeChoir:function(t,e){this.activeChoir}},methods:{isEditing:function(t,e){var i=this.$store.getters.activeChoir,r=this.$store.getters.activeCriterion,o=i?i.id:null,n=r?r.id:null;return t.id===o&&e.id===n&&this.activeModal},displayScoringInactiveMessage:function(){alert("Scoring is currently inactive.")},activateModal:function(t){this.$store.commit("startModalProtection"),this.$store.commit("activateModal",t)},activateChoirModal:function(t){this.$store.commit("startModalProtection"),this.isSpreadsheetScoringActive?this.$store.commit("activateChoirModal",t):this.displayScoringInactiveMessage()},activateChoirCommentModal:function(t){this.$store.commit("startModalProtection"),this.isSpreadsheetScoringActive?this.$store.commit("activateChoirCommentModal",t):this.displayScoringInactiveMessage()},activateCriterionModal:function(t){this.$store.commit("startModalProtection"),this.isSpreadsheetScoringActive?this.$store.commit("activateCriterionModal",t):this.displayScoringInactiveMessage()},activateChoirCriterionModal:function(t,e){this.$store.commit("startModalProtection"),this.isSpreadsheetScoringActive?this.activeModal?this.deactivateModal():this.$store.commit("activateChoirCriterionModal",{choir:t,criterion:e}):this.displayScoringInactiveMessage()},activateCriterion:function(t){this.activeCriterion=t,this.$store.commit("activateCriterion",this.activeCriterion)},deactiveCriterion:function(){this.activeCriterion=null},activateChoir:function(t){this.activeChoir=t,this.$store.commit("activateChoir",this.activeChoir)},activateChoirCriterion:function(t,e){this.activeChoir=t,this.activeCriterion=e,this.$store.commit("activateChoir",this.activeChoir),this.$store.commit("activateCriterion",this.activeCriterion)},deactiveChoir:function(){this.activeChoir=null},deactivateModal:function(){this.$store.commit("deactivateModal")},incrementCount:function(){this.$store.commit("increment")},setCount:function(t){this.$store.commit("setCount",t)},score:function(t,e){return this.$store.getters.getChoirCriterionScore(t.id,e.id)},choirRank:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=t.total_score?this.toOrdinal(t.rank):"--";return e?i+" "+e:i},choirRankTied:function(t){if(t.total_score&&t.rank_tied)return!0},updateChoirsRanks:function(){return this.$store.getters.updateChoirsRanks},choirTotalScore:function(t){return this.$store.getters.getChoirTotalScore(t.id)},choirTotalWeightedScore:function(t){return this.$store.getters.getChoirTotalWeightedScore(t.id)},scoreToRating:function(t){return this.$store.getters.getChoirRating(t)},getChoirCaptionSubtotalScore:function(t,e){return this.$store.getters.getChoirCaptionSubtotalScore(t.id,e.id)},getChoirCaptionRank:function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.$store.getters.getChoirCaptionRank(t.id,e.id)},choirCaptionRank:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=this.getChoirCaptionRank(t,e),o=r.caption_score?this.toOrdinal(r.rank):"--";return i?o+" "+i:o},choirCaptionRankTied:function(t,e){var i=this.getChoirCaptionRank(t,e);if(i.caption_score&&i.rank_tied)return!0},comment:function(t){return this.$store.getters.getChoirComment(t.id)},onRecordingStart:function(t){this.currentRecordingId=t,this.changeInProgressRecValue(1)},changeInProgressRecValue:function(t){var e=document.getElementById("recordingsInProgress");e.value=parseInt(e.value)+t},getSavingStatus:function(t){return this.$store.getters.getSavingStatus(t)},getSavedStatus:function(t){return this.$store.getters.getSavedStatus(t)},getErroredStatus:function(t){return this.$store.getters.getErroredStatus(t)},warnRecordingSaveError:function(){alert("There was an error saving your recording to the server.  You can save your recording to your device using the link in the recording name.  Then refresh this page and try uploading the file.")},warnUploadRecordingError:function(){alert("There was an error uploading your file to the server.  Please refresh this page and try uploading the file again.")}},mounted:function(){this.updateChoirsRanks()},beforeUpdate:function(){this.updateChoirsRanks()}},M={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"spreadsheet"}},[i("table",[i("thead",[i("tr",{staticClass:"table-header"},[i("th",{staticClass:"criteria-header"}),t._v(" "),t._l(t.choirsList,function(e){return i("th",{key:e.id,staticClass:"choir-header",attrs:{choir:e}},[i("span",{staticClass:"clickable",on:{click:function(i){t.activateChoirModal(e)}}},[t._v(t._s(e.name))])])})],2)]),t._v(" "),i("tbody",[t._l(t.captionsList,function(e){return[i("tr",{key:e.id,staticClass:"caption-row caption-header"},[i("th",{staticClass:"caption-name",class:["background-color-"+e.color_id]},[t._v("\n          "+t._s(e.name)+"\n        ")]),t._v(" "),i("td",{class:["background-color-"+e.color_id],attrs:{colspan:t.choirsList.length}})]),t._v(" "),t._l(t.criteriaList.filter(function(t){return t.caption_id===e.id}),function(r){return i("tr",{key:r.id,staticClass:"criteria-row"},[i("th",{staticClass:"criterion-name"},[i("span",{staticClass:"clickable",on:{click:function(e){t.activateCriterionModal(r)}}},[t._v(t._s(r.name))])]),t._v(" "),t._l(t.choirsList,function(o){return i("td",{key:o.id,staticClass:"caption-value",class:{editing:t.isEditing(o,r),saving:t.getSavingStatus(o.id+"_"+e.id+"_"+r.id),saved:t.getSavedStatus(o.id+"_"+e.id+"_"+r.id),errored:t.getErroredStatus(o.id+"_"+e.id+"_"+r.id)},attrs:{choir:o,criterion:r},on:{click:function(e){t.activateChoirCriterionModal(o,r)}}},[t._v(t._s(t.score(o,r)))])})],2)}),t._v(" "),i("tr",{key:e.id,staticClass:"caption-row caption-footer"},[i("th",{staticClass:"caption-subtotal caption-subtotal-label",class:["lighter-background-color-"+e.color_id]},[t._v("\n          "+t._s(e.name)+" "),1===e.id&&1===t.captionWeightingId?i("span",[t._v("Raw")]):t._e(),t._v(" Subtotal\n          "),1===e.id&&1===t.captionWeightingId?i("div",[t._v(t._s(e.name)+" Weighted Subtotal")]):t._e()]),t._v(" "),t._l(t.choirsList,function(r){return i("td",{key:r.id,staticClass:"caption-subtotal caption-subtotal-value",class:["lighter-background-color-"+e.color_id],attrs:{choir:r}},[t._v("\n            "+t._s(t.getChoirCaptionSubtotalScore(r,e))+"\n            "),1===e.id&&1===t.captionWeightingId?i("div",[t._v(t._s(1.5*t.getChoirCaptionSubtotalScore(r,e)))]):t._e()])})],2),t._v(" "),i("tr",{key:e.id,staticClass:"caption-row caption-footer"},[i("th",{staticClass:"caption-rank caption-rank-label",class:["lighter-background-color-"+e.color_id]},[t._v("\n          "+t._s(e.name)+" Rank\n        ")]),t._v(" "),t._l(t.choirsList,function(r){return i("td",{key:r.id,staticClass:"caption-rank caption-rank-value",class:["lighter-background-color-"+e.color_id],attrs:{choir:r}},[t._v("\n            "+t._s(t.choirCaptionRank(r,e,"Place"))+" "),t.choirCaptionRankTied(r,e)?i("span",{staticClass:"tied-badge"},[t._v("Tied")]):t._e()])})],2)]}),t._v(" "),i("tr",{staticClass:"score-row"},[i("th",{staticClass:"score-total-label"},[1===t.captionWeightingId?i("span",[t._v("Raw")]):t._e(),t._v(" Total\n          "),1===t.captionWeightingId?i("div",[t._v("Weighted Total")]):t._e()]),t._v(" "),t._l(t.choirsList,function(e){return i("td",{key:e.id,staticClass:"score-total-value",attrs:{choir:e}},[t._v("\n          "+t._s(t.choirTotalScore(e))+"\n          "),1===t.captionWeightingId?i("div",[t._v(t._s(t.choirTotalWeightedScore(e)))]):t._e()])})],2),t._v(" "),i("tr",{staticClass:"rank-rating-row"},[i("th",{staticClass:"rank-rating-label"},[t._v("\n          Rank "),t.hasRatings?i("span",[t._v("& Rating")]):t._e()]),t._v(" "),t._l(t.choirsList,function(e){return i("td",{key:e.id,staticClass:"rank-rating-value",attrs:{choir:e}},[t._v("\n          "+t._s(t.choirRank(e,"Place"))+" "),t.choirRankTied(e)?i("span",{staticClass:"tied-badge"},[t._v("Tied")]):t._e(),i("br"),t._v(" "),t.hasRatings?i("span",[t._v(t._s(t.scoreToRating(e.total_score)))]):t._e()])})],2),t._v(" "),i("tr",{staticClass:"comment-row"},[i("th",{staticClass:"criterion-name"},[t._v("Comments")]),t._v(" "),t._l(t.choirsList,function(e){return i("td",{key:e.id,staticClass:"comment-text",attrs:{choir:e},on:{click:function(i){t.activateChoirCommentModal(e)}}},[t._v("\n          "+t._s(t.comment(e))+"\n        ")])})],2),t._v(" "),t.hasPremium?i("tr",{staticClass:"comment-row"},[i("th",{staticClass:"criterion-name"},[t._v("Record Comments")]),t._v(" "),t._l(t.choirsList,function(e){return i("td",{key:e.id},[i("Record",{attrs:{recordsList:t.recordsList,choir:e,recordings:t.recordings},on:{"start-recording":function(i){t.onRecordingStart(e.id)},"stop-recording":function(e){t.currentRecordingId=null},"upload-complete":function(e){t.changeInProgressRecValue(-1)},"upload-error":t.warnRecordingSaveError}})],1)})],2):t._e(),t._v(" "),t.hasPremium?i("tr",{staticClass:"comment-row"},[i("th",{staticClass:"criterion-name"},[t._v("Upload Recorded File")]),t._v(" "),t._l(t.choirsList,function(e){return i("td",{key:e.id},[i("DropZone",{attrs:{choir:e},on:{"upload-start":function(e){t.changeInProgressRecValue(1)},"upload-complete":function(e){t.changeInProgressRecValue(-1)},"upload-error":t.warnUploadRecordingError}})],1)})],2):t._e()],2)])])},staticRenderFns:[]};var w=i("VU/8")(S,M,!1,function(t){i("YfQ5")},"data-v-7a7e4bda",null).exports,R={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:"modal"},on:{click:function(t){t.stopPropagation()}}},[this._t("default")],2)},staticRenderFns:[]};var b=i("VU/8")({name:"Modal"},R,!1,function(t){i("E4tw")},"data-v-57fcc2ea",null).exports,y={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:"modal-header"}},[this._t("default")],2)},staticRenderFns:[]};var T=i("VU/8")({name:"ModalHeader",methods:{deactivateModal:function(){this.$store.commit("deactivateModal")}}},y,!1,function(t){i("RtM3")},"data-v-7ceb8341",null).exports,$={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:"modal-subheader"}},[this._t("default")],2)},staticRenderFns:[]};var k=i("VU/8")({name:"ModalSubheader"},$,!1,function(t){i("pTcm")},"data-v-22e7bf4a",null).exports,I={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:"modal-body"}},[this._t("default")],2)},staticRenderFns:[]};var x=i("VU/8")({name:"ModalBody"},I,!1,function(t){i("j5Ya")},"data-v-a19b1eb2",null).exports,E={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:"modal-footer"}},[this._t("default")],2)},staticRenderFns:[]};var A=i("VU/8")({name:"ModalFooter"},E,!1,function(t){i("DRjT")},"data-v-adc6c0ce",null).exports,L={name:"CriterionScoringRange",props:{min:Number,max:Number,increment:Number,displayType:String}},U={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"valid-scores-summary",class:t.displayType},["expanded"===t.displayType?i("div",{staticClass:"expanded-version"},[i("span",{staticClass:"label"},[t._v("Min:")]),t._v(" "+t._s(t.min)+",\n    "),i("span",{staticClass:"label"},[t._v("Max:")]),t._v(" "+t._s(t.max)+",\n    "),i("span",{staticClass:"label"},[t._v("Increment:")]),t._v(" "+t._s(t.increment)+"\n  ")]):t._e(),t._v(" "),"condensed"===t.displayType?i("div",{staticClass:"condensed-version"},[t._v("\n    "+t._s(t.min)+" - "+t._s(t.max)+" @ "+t._s(t.increment)+"\n  ")]):t._e()])},staticRenderFns:[]};var F=i("VU/8")(L,U,!1,function(t){i("0tw1")},"data-v-33935945",null).exports,N={name:"ScoreButton",props:{score:Number,currentScore:Number,size:{type:String,default:"large"}}},P={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{staticClass:"score-button",class:t.size,on:{click:function(e){t.$emit("score-changed")}}},[t._v(t._s(t.score))])},staticRenderFns:[]};var B=i("VU/8")(N,P,!1,function(t){i("P/Gc")},"data-v-1428f493",null).exports,O={name:"ScoreOption",props:{score:Number,currentScore:Number}},D={render:function(){var t=this.$createElement;return(this._self._c||t)("option",{staticClass:"score-option",domProps:{value:this.score}},[this._v(this._s(this.score))])},staticRenderFns:[]};var z={name:"Score",components:{CriterionScoringRange:F,ScoreButton:B,ScoreOption:i("VU/8")(O,D,!1,function(t){i("hzzq")},"data-v-5dbfab10",null).exports},props:{min:Number,max:Number,increment:Number,initialScore:Number,isScoringActive:Boolean,showIncrements:Boolean,showScoreChoices:Boolean,showScoringRange:Boolean,incrementOutlined:Boolean,displayType:String,choirId:Number,criterionId:Number,captionId:Number,scoreButtonSize:{default:"large"}},data:function(){return{currentScore:this.initialScore}},computed:{range:function(){for(var t=[],e=this.min;e<=this.max;e+=this.increment)t.push(e);return t},isScoreChanged:function(){return this.currentScore!==this.initialScore},isIncrementOutlined:function(){return this.incrementOutlined},displayScore:function(){return this.currentScore?this.currentScore:"-"}},watch:{currentScore:function(t,e){var i={choir_id:this.choirId,criterion_id:this.criterionId,caption_id:this.captionId,raw_score:t};this.$store.dispatch("setScore",i)}},methods:{down:function(t){var e=this.currentScore-this.increment;e>=this.min&&(this.currentScore=e)},up:function(t){var e=this.currentScore+this.increment;e<=this.max&&(this.currentScore=e)},change:function(t){t>=this.min&&t<=this.max&&(this.currentScore=t)},getSavingStatus:function(t){return this.$store.getters.getSavingStatus(t)},getSavedStatus:function(t){return this.$store.getters.getSavedStatus(t)},getErroredStatus:function(t){return this.$store.getters.getErroredStatus(t)}}},V={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"score-container",class:t.displayType},[i("div",{staticClass:"row",class:t.displayType},[t.showIncrements&&t.isScoringActive?i("button",{staticClass:"score-down score-increment",class:{outlined:t.isIncrementOutlined},on:{click:t.down}},[t._v("-")]):t._e(),t._v(" "),i("div",{staticClass:"current-score",class:{saving:t.getSavingStatus(t.choirId+"_"+t.captionId+"_"+t.criterionId),saved:t.getSavedStatus(t.choirId+"_"+t.captionId+"_"+t.criterionId),errored:t.getErroredStatus(t.choirId+"_"+t.captionId+"_"+t.criterionId)}},[t._v(t._s(t.displayScore))]),t._v(" "),t.showIncrements&&t.isScoringActive?i("button",{staticClass:"score-up score-increment",class:{outlined:t.isIncrementOutlined},on:{click:t.up}},[t._v("+")]):t._e()]),t._v(" "),t.showScoringRange?i("CriterionScoringRange",{attrs:{min:t.min,max:t.max,increment:t.increment}}):t._e(),t._v(" "),t.showScoreChoices&&t.isScoringActive?i("div",{staticClass:"score-buttons",class:[t.displayType,{doubleRow:.5===t.increment}]},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.currentScore,expression:"currentScore"}],staticClass:"score-select",on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.currentScore=e.target.multiple?i:i[0]}}},[i("option",{staticClass:"score-option",domProps:{value:t.initialScore}},[t._v("Select Score...")]),t._v(" "),t._l(t.range,function(e){return i("ScoreOption",{key:e,attrs:{score:e,currentScore:t.currentScore},on:{"score-changed":function(i){t.change(e)}}})})],2),t._v(" "),t._l(t.range,function(e){return i("ScoreButton",{key:e,class:{active:t.currentScore===e},attrs:{score:e,currentScore:t.currentScore,size:t.scoreButtonSize},on:{"score-changed":function(i){t.change(e)}}})})],2):t._e()],1)])},staticRenderFns:[]};var W=i("VU/8")(z,V,!1,function(t){i("av/C")},"data-v-6ac4d03d",null).exports,H={name:"ChoirScore",components:{Score:W},props:{choir:Object,criterion:Object,isScoringActive:Boolean,score:Number},methods:{activateScoring:function(){this.scoringActive=!0},deactivateScoring:function(){this.scoringActive=!1},toggleScoring:function(){this.scoringActive=!this.scoringActive},saveScoring:function(){this.scoringActive=!1}},data:function(){return{currentCriterion:this.criterion,scoringActive:this.isScoringActive,displayType:"compact",scoreButtonSize:"small"}},computed:{currentChoir:function(){return this.choir},currentScore:function(){return this.score}}},j={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",{staticClass:"choir-score"},[i("td",{staticClass:"choir-column"},[i("div",{on:{click:t.activateScoring}},[t._v("\n      "+t._s(t.currentChoir.name)+"\n    ")]),t._v(" "),t.scoringActive?i("button",{staticClass:"deactive-scoring-button",on:{click:t.deactivateScoring}},[t._v("Done scoring")]):t._e()]),t._v(" "),i("td",{on:{click:t.activateScoring}},[i("Score",{attrs:{min:t.currentCriterion.minScore,max:t.currentCriterion.maxScore,initialScore:t.currentScore,increment:t.currentCriterion.increment,showIncrements:!0,showScoreChoices:!0,showScoringRange:!1,isScoringActive:t.scoringActive,displayType:t.displayType,choirId:t.currentChoir.id,criterionId:t.currentCriterion.id,captionId:t.currentCriterion.caption_id,scoreButtonSize:t.scoreButtonSize}})],1)])},staticRenderFns:[]};var G={name:"ChoirScores",components:{Score:W,ChoirScore:i("VU/8")(H,j,!1,function(t){i("mnaM")},"data-v-26175446",null).exports},props:{choirsList:Array,criterion:Object,scores:Array},methods:{score:function(t){var e=this.scores.filter(function(e){return e.choir_id===t});return 1===e.length?e[0].raw_score:null}}},Y={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("table",{staticClass:"choirs-scores"},[t._m(0),t._v(" "),t._l(t.choirsList,function(e){return i("ChoirScore",{key:e.id,attrs:{choir:e,criterion:t.criterion,score:t.score(e.id)}})})],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("tr",{staticClass:"table-header"},[e("th",{staticClass:"choir-column"},[this._v("Choir name")]),this._v(" "),e("th",{staticClass:"score-column"},[this._v("Score")])])}]};var q={name:"CriterionModal",components:{Modal:b,ModalHeader:T,ModalSubheader:k,ModalBody:x,ModalFooter:A,Score:W,ChoirScores:i("VU/8")(G,Y,!1,function(t){i("P77S")},"data-v-2f909508",null).exports,CriterionScoringRange:F},data:function(){return{criterionScoringRangeDisplayType:"expanded"}},computed:{criterion:function(){return this.$store.getters.activeCriterion},choirsList:function(){return this.$store.getters.getChoirsList},scores:function(){return this.$store.getters.getCriterionScores(this.criterion.id)}},watch:{},methods:{}},Q={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Modal",[i("ModalHeader",[i("h1",[t._v(t._s(t.criterion.name))]),t._v(" "),i("CriterionScoringRange",{attrs:{min:t.criterion.minScore,max:t.criterion.maxScore,increment:t.criterion.increment,displayType:t.criterionScoringRangeDisplayType}})],1),t._v(" "),i("ModalSubheader",[i("p",[t._v("\n      "+t._s(t.criterion.description)+"\n    ")])]),t._v(" "),i("ModalBody",[i("ChoirScores",{attrs:{criterion:t.criterion,choirsList:t.choirsList,scores:t.scores}})],1)],1)},staticRenderFns:[]};var K=i("VU/8")(q,Q,!1,function(t){i("Jr11")},"data-v-aea5a406",null).exports,X={name:"ChoirCriterionModal",components:{Modal:b,ModalHeader:T,ModalBody:x,ModalFooter:A,Score:W},data:function(){return{displayType:"expanded"}},computed:{criterion:function(){return this.$store.getters.activeCriterion},choir:function(){return this.$store.getters.activeChoir},currentScore:function(){return this.$store.getters.getChoirCriterionScore(this.choir.id,this.criterion.id)}},watch:{},methods:{}},Z={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Modal",[i("ModalBody",[i("Score",{attrs:{min:t.criterion.minScore,max:t.criterion.maxScore,initialScore:t.currentScore,increment:t.criterion.increment,showIncrements:!0,showScoreChoices:!0,showScoringRange:!0,incrementOutlined:!0,isScoringActive:!0,displayType:t.displayType,choirId:t.choir.id,criterionId:t.criterion.id,captionId:t.criterion.caption_id}})],1),t._v(" "),i("ModalFooter",[i("p",[t._v("\n      "+t._s(t.criterion.description)+"\n    ")])])],1)},staticRenderFns:[]};var J=i("VU/8")(X,Z,!1,function(t){i("vZP6")},"data-v-69437f57",null).exports,tt={name:"CriterionScore",components:{Score:W,CriterionScoringRange:F},props:{choir:Object,criterion:Object,isScoringActive:Boolean,showCriterionDescription:Boolean,score:Number},methods:{activateScoring:function(){this.scoringActive=!0},deactivateScoring:function(){this.scoringActive=!1},toggleScoring:function(){this.scoringActive=!this.scoringActive},saveScoring:function(){this.scoringActive=!1},toggleCriterionDescription:function(){this.showCriterionDescription=!this.showCriterionDescription}},data:function(){return{currentChoir:this.choir,currentCriterion:this.criterion,scoringActive:this.isScoringActive,displayType:"inline",criterionScoringRangeDisplayType:"condensed",scoreButtonSize:"small"}},computed:{currentScore:function(){return this.score}}},et={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",{staticClass:"criterion-score"},[i("td",{staticClass:"criterion-column"},[i("div",{on:{click:t.activateScoring}},[t._v("\n      "+t._s(t.currentCriterion.name)+"\n    ")]),t._v(" "),i("CriterionScoringRange",{attrs:{min:t.currentCriterion.minScore,max:t.currentCriterion.maxScore,increment:t.currentCriterion.increment,displayType:t.criterionScoringRangeDisplayType}})],1),t._v(" "),i("td",{on:{click:t.activateScoring}},[i("Score",{attrs:{min:t.currentCriterion.minScore,max:t.currentCriterion.maxScore,initialScore:t.currentScore,increment:t.currentCriterion.increment,incrementOutlined:!0,showIncrements:!0,showScoreChoices:!0,showScoringRange:!1,isScoringActive:t.scoringActive,displayType:t.displayType,choirId:t.choir.id,criterionId:t.currentCriterion.id,captionId:t.currentCriterion.caption_id,scoreButtonSize:t.scoreButtonSize}})],1)])},staticRenderFns:[]};var it={name:"CriteriaScores",components:{CriterionScore:i("VU/8")(tt,et,!1,function(t){i("kQIC")},"data-v-7289c988",null).exports},props:{criteriaList:Array,choir:Object,scores:Array,caption:Object},methods:{score:function(t){var e=this.scores.filter(function(e){return e.criterion_id===t});return 1===e.length?e[0].raw_score:null},choirTotalScore:function(t){return this.$store.getters.getChoirTotalScore(t.id)},getChoirCaptionSubtotalScore:function(t,e){return this.$store.getters.getChoirCaptionSubtotalScore(t.id,e.id)}}},rt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("table",{staticClass:"criteria-scores"},[i("tr",{staticClass:"caption-header",class:["background-color-"+t.caption.color_id]},[i("th",{staticClass:"caption-name",attrs:{colspan:"2"}},[t._v(t._s(t.caption.name))])]),t._v(" "),t._m(0),t._v(" "),t._l(t.criteriaList,function(e){return i("CriterionScore",{key:e.id,attrs:{choir:t.choir,criterion:e,score:t.score(e.id),isScoringActive:!0}})}),t._v(" "),i("tr",{staticClass:"caption-row caption-footer"},[i("td",{staticClass:"caption-subtotal caption-subtotal-label",class:["lighter-background-color-"+t.caption.color_id]},[t._v("\n      Subtotal\n    ")]),t._v(" "),i("td",{staticClass:"caption-subtotal caption-subtotal-value",class:["lighter-background-color-"+t.caption.color_id]},[t._v("\n      "+t._s(t.getChoirCaptionSubtotalScore(t.choir,t.caption))+"\n    ")])])],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("tr",{staticClass:"table-header"},[e("th",{staticClass:"criterion-column"},[this._v("Criteria")]),this._v(" "),e("th",{staticClass:"score-column"},[this._v("Score")])])}]};var ot={name:"ChoirModal",components:{Modal:b,ModalHeader:T,ModalSubheader:k,ModalBody:x,ModalFooter:A,CriteriaScores:i("VU/8")(it,rt,!1,function(t){i("edXu")},"data-v-a1b7f590",null).exports},data:function(){return{criteriaList:this.$store.state.criteriaList,captionsList:this.$store.state.captionsList,activeCaption:this.$store.state.captionsList[0]}},computed:{choir:function(){return this.$store.getters.activeChoir},scores:function(){return this.$store.getters.activeChoirScores},choirTotalScore:function(){return this.$store.getters.getChoirTotalScore(this.$store.getters.activeChoir.id)}},methods:{activateCaption:function(t){this.activeCaption=t}}},nt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Modal",[i("ModalHeader",[i("h1",[t._v(t._s(t.choir.name))])]),t._v(" "),i("ModalSubheader",[i("div",{staticClass:"tab-buttons-container"},[t._v("\n\n      Toggle Caption to Score:\n      "),t._l(t.captionsList,function(e){return i("button",{key:e.id,staticClass:"caption-tab-button",class:["background-color-"+e.color_id],attrs:{type:"button"},on:{click:function(i){t.activateCaption(e)}}},[t._v("\n        "+t._s(e.name)+"\n      ")])})],2)]),t._v(" "),i("ModalBody",[t._l(t.captionsList,function(e){return[t.activeCaption===e?i("CriteriaScores",{key:e.id,attrs:{criteriaList:t.criteriaList.filter(function(t){return t.caption_id===e.id}),choir:t.choir,scores:t.scores,caption:e}}):t._e()]}),t._v(" "),i("table",[i("tr",{staticClass:"score-row"},[i("td",{staticClass:"score-total-label"},[t._v("\n          Total\n        ")]),t._v(" "),i("td",{staticClass:"score-total-value score-column"},[t._v("\n          "+t._s(t.choirTotalScore)+"\n        ")])])])],2)],1)},staticRenderFns:[]};var ct=i("VU/8")(ot,nt,!1,function(t){i("N7k7")},"data-v-5f9f2e69",null).exports,at={name:"ChoirCommentModal",components:{Modal:b,ModalHeader:T,ModalBody:x,ModalFooter:A,ModalSubheader:k},data:function(){return{initialComment:this.$store.getters.getChoirComment(this.$store.getters.activeChoir.id),currentComment:this.$store.getters.getChoirComment(this.$store.getters.activeChoir.id)}},methods:{autosaveComment:function(t){var e={choir_id:this.choir.id,round_id:this.choir.round_id,comment:t.target.value};this.$store.dispatch("setComment",e)},saveComment:function(t){var e={choir_id:this.choir.id,round_id:this.choir.round_id,comment:this.currentComment};this.$store.dispatch("setComment",e),this.$store.commit("deactivateModal")},cancelComment:function(t){var e={choir_id:this.choir.id,round_id:this.choir.round_id,comment:this.initialComment};this.$store.dispatch("setComment",e),this.$store.commit("deactivateModal")}},computed:{choir:function(){return this.$store.getters.activeChoir},comment:{get:function(){return this.$store.getters.getChoirComment(this.choir.id)},set:function(t){this.currentComment=t}}},mounted:function(){var t=this;document.getElementsByTagName("textarea")[0].addEventListener("input",function(e){t.autosaveComment(e)})}},st={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Modal",[i("ModalHeader",[i("h1",[t._v(t._s(t.choir.name))]),t._v(" "),i("h3",[t._v("Feeback")])]),t._v(" "),i("ModalSubheader",[i("p",[t._v("Please keep your feedback positive and constructive.")])]),t._v(" "),i("ModalBody",[i("textarea",{directives:[{name:"model",rawName:"v-model.lazy",value:t.comment,expression:"comment",modifiers:{lazy:!0}}],domProps:{value:t.comment},on:{change:function(e){t.comment=e.target.value}}}),t._v(" "),i("button",{staticClass:"button",attrs:{type:"submit"},on:{click:function(e){t.saveComment()}}},[t._v("Save Comment")]),t._v(" "),i("button",{staticClass:"button cancel",attrs:{type:"submit"},on:{click:function(e){t.cancelComment()}}},[t._v("Cancel")])])],1)},staticRenderFns:[]};var dt=i("VU/8")(at,st,!1,function(t){i("xQCc")},"data-v-64dec75e",null).exports,ut={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"spreadsheet-header"}},[i("a",{staticClass:"button back-button",attrs:{href:t.backUrl}},[t._v("Back to previous screen")]),t._v(" "),i("h2",[t._v(" "+t._s(t.spreadsheetTitle)+"\n    "),t.isSpreadsheetScoringActive?i("div",{staticClass:"scoring-status"},[t._v("\n      Scoring is active\n    ")]):t._e(),t._v(" "),t.isSpreadsheetScoringActive?t._e():i("div",{staticClass:"scoring-status"},[t._v("\n      Scores can't be edited now.\n    ")])])])},staticRenderFns:[]};var lt={name:"App",components:{SpreadsheetHeader:i("VU/8")({name:"SpreadsheetHeader",computed:{scoringStatus:function(){return this.$store.state.scoringStatus},isSpreadsheetScoringActive:function(){return this.$store.state.isSpreadsheetScoringActive},spreadsheetTitle:function(){return this.$store.state.spreadsheetTitle},backUrl:function(){return this.$store.state.backUrl}}},ut,!1,function(t){i("TFWe")},"data-v-254cc4d1",null).exports,Spreadsheet:w,CriterionModal:K,ChoirCriterionModal:J,ChoirCommentModal:dt,ChoirModal:ct},computed:{scores:function(){return this.$store.state.scores},activeChoir:function(){return this.$store.getters.activeChoir},activeCriterion:function(){return this.$store.getters.activeCriterion},activeModal:function(){return this.$store.state.activeModal},protectModal:function(){return this.$store.state.protectModal},activeComment:function(){return this.$store.state.activeComment},activeModalType:function(){return this.activeModal?this.activeChoir&&this.activeCriterion?"choirCriterion":this.activeChoir&&this.activeComment?"choirComment":this.activeChoir?"choir":this.activeCriterion?"criterion":void 0:null}},methods:{deactivateModal:function(t){this.activeModal&&!this.protectModal&&this.$store.commit("deactivateModal"),this.$store.commit("endModalProtection")}},mounted:function(){document.addEventListener("click",this.deactivateModal)}},ht={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("SpreadsheetHeader"),t._v(" "),i("Spreadsheet",{class:[{fixed:t.activeModal&&"choirCriterion"!==t.activeModalType},{spaceBelow:t.activeModal&&"choirCriterion"===t.activeModalType}]}),t._v(" "),t.activeModal&&"choirCriterion"!==t.activeModalType?i("div",{class:t.activeModalType,attrs:{id:"modal-cover"}}):t._e(),t._v(" "),i("div",{attrs:{id:"modal-wrapper"}},["criterion"===t.activeModalType?i("CriterionModal",{class:t.activeModalType}):t._e(),t._v(" "),"choir"===t.activeModalType?i("ChoirModal",{class:t.activeModalType}):t._e(),t._v(" "),"choirComment"===t.activeModalType?i("ChoirCommentModal",{class:t.activeModalType}):t._e(),t._v(" "),"choirCriterion"===t.activeModalType?i("ChoirCriterionModal",{class:t.activeModalType}):t._e()],1)],1)},staticRenderFns:[]};var vt=i("VU/8")(lt,ht,!1,function(t){i("ntvR")},null,null).exports,mt=i("BO1k"),_t=i.n(mt),pt=i("bOdI"),ft=i.n(pt),gt=i("woOf"),Ct=i.n(gt),St=i("NYxO"),Mt=function(t){var e={round_id:t.round_id,choir_id:t.choir_id,comment:t.comment};return l.a.post("/judge/comment/save",e).then(function(t){return t.data})},wt=function(t){return l.a.post("/judge/recording/save",t).then(function(t){return t.data})},Rt=function(t,e){e=void 0===e?null:e;var i={choir_id:t.choir_id,criterion_id:t.criterion_id,score:t.raw_score,round_id:t.round_id,division_id:t.division_id};return l.a.post("/judge/score/save",i).then(function(i){var r=t.choir_id+"_"+t.caption_id+"_"+t.criterion_id;return e&&(e.commit("setSavingStatus",ft()({},r,!1)),i.data.success?e.commit("setSavedStatus",ft()({},r,!0)):e.commit("setErroredStatus",ft()({},r,!0))),i.data},function(i){var r=t.choir_id+"_"+t.caption_id+"_"+t.criterion_id;return e.commit("setErroredStatus",ft()({},r,!0)),i.data})},bt=i("M4fF"),yt=i.n(bt),Tt=window.__CAPTIONS__?window.__CAPTIONS__:[{id:1,name:"Music",color_id:6},{id:2,name:"Show",color_id:3}],$t=window.__CAPTION_WEIGHTING_ID__?window.__CAPTION_WEIGHTING_ID__:1,kt=window.__DIVISIONS__?window.__DIVISIONS__:[{id:1,name:"Mixed High School"}],It=window.__CHOIRS__?window.__CHOIRS__:[{id:1,name:"Alameda Aeronauts",round_id:4,division_id:8,performance_order:3},{id:2,name:"Bloomington South Panthers",round_id:4,division_id:8,performance_order:2},{id:3,name:"Canton McKinley Bulldogs",round_id:4,division_id:8,performance_order:1},{id:4,name:"Dayton Dragons",round_id:4,division_id:8,performance_order:4},{id:5,name:"Edgewood Eagles",round_id:4,division_id:8,performance_order:7},{id:6,name:"Fairless Falcons",round_id:4,division_id:8,performance_order:6},{id:7,name:"Galveston Geese",round_id:4,division_id:8,performance_order:5}],xt=window.__CRITERIA__?window.__CRITERIA__:[{id:1,caption_id:1,name:"Tone & Technique",description:"This is a description of the Style criterion...",minScore:0,maxScore:8,increment:.5},{id:2,caption_id:1,name:"Intonation",description:"This is a description of this criterion...",minScore:0,maxScore:10,increment:.5},{id:3,caption_id:2,name:"Balance & Clarity",description:"This is a description of this criterion...",minScore:0,maxScore:10,increment:1},{id:4,caption_id:2,name:"Blend",description:"This is a description of this criterion...",minScore:0,maxScore:8,increment:.5},{id:5,caption_id:1,name:"Diction",description:"This is a description of this criterion...",minScore:0,maxScore:10,increment:.5},{id:6,caption_id:2,name:"Community & Expression",description:"This is a description of this criterion...",minScore:0,maxScore:10,increment:.5},{id:7,caption_id:2,name:"Consistency",description:"This is a description of this criterion...",minScore:0,maxScore:10,increment:.5},{id:8,caption_id:2,name:"Staging & Transitions",description:"This is a description of this criterion...",minScore:0,maxScore:10,increment:.5},{id:9,caption_id:2,name:"Appearance & Poise",description:"This is a description of this criterion...",minScore:0,maxScore:10,increment:.5},{id:10,caption_id:2,name:"Entertainment Value",description:"This is a description of this criterion...",minScore:0,maxScore:10,increment:.5},{id:11,caption_id:1,name:"Balance & Blend",description:"This is a description of this criterion...",minScore:0,maxScore:10,increment:.5},{id:12,caption_id:1,name:"Rhythm & Precision",description:"This is a description of this criterion...",minScore:0,maxScore:10,increment:.5}],Et=window.__SCORES__?window.__SCORES__:[{choir_id:1,criterion_id:1,caption_id:1,raw_score:7},{choir_id:1,criterion_id:2,caption_id:1,raw_score:8},{choir_id:1,criterion_id:3,caption_id:2,raw_score:9},{choir_id:2,criterion_id:1,caption_id:1,raw_score:7.5},{choir_id:2,criterion_id:2,caption_id:1,raw_score:6},{choir_id:2,criterion_id:3,caption_id:2,raw_score:7},{choir_id:3,criterion_id:1,caption_id:1,raw_score:4},{choir_id:3,criterion_id:2,caption_id:1,raw_score:4},{choir_id:3,criterion_id:3,caption_id:2,raw_score:4.5},{choir_id:4,criterion_id:4,caption_id:2,raw_score:8.5}],At=window.__COMMENTS__?window.__COMMENTS__:[{choir_id:1,comment:"This is a comment.."},{choir_id:2,comment:"aaaaa  adfd This is a comment.."},{choir_id:3,comment:"This is a asdfsaaa  comment.."},{choir_id:4,comment:"This is a fds a  sd fcomment.."}],Lt=window.__RATINGS__?yt.a.values(window.__RATINGS__):[{name:"Gold",min_score:90},{name:"Silver",min_score:80},{name:"Bronze",min_score:70},{name:"Tin",min_score:60}],Ut=window.__RECORDED_COMMENTS__||[],Ft=window.__Competition__||[],Nt=window.__SPREADSHEET_TITLE__?window.__SPREADSHEET_TITLE__:"Spreadsheet title",Pt=window.__BACK_URL__?window.__BACK_URL__:"/test-back-url",Bt="Active"===window.__IS_SPREADSHEET_SCORING_ACTIVE__;r.a.use(St.a);var Ot=yt.a.debounce(Mt,1e3),Dt=wt,zt=(yt.a.debounce(Rt,1e3),yt.a.wrap(yt.a.memoize(function(){return yt.a.debounce(Rt,500)},yt.a.property(["choir_id","criterion_id"])),function(t,e,i){return t(e,i)(e,i)})),Vt=new St.a.Store({state:{count:0,isSpreadsheetScoringActive:Bt,captionsList:Tt,captionWeightingId:$t,divisions:kt,recordings:Ut,competition:Ft,choirsList:It,criteriaList:xt,scores:Et,saving:{},saved:{},errored:{},comments:At,ratings:Lt,activeModal:!1,protectModal:!1,activeCriterion:!1,activeChoir:!1,activeComment:!1,spreadsheetTitle:Nt,backUrl:Pt},mutations:{activateModal:function(t,e){t.activeModal=!0},startModalProtection:function(t,e){t.protectModal=!0},activateChoirCommentModal:function(t,e){t.activeModal=!0,t.activeComment=!0,t.activeChoir=e,t.activeCriterion=!1},activateChoirModal:function(t,e){t.activeModal=!0,t.activeComment=!1,t.activeChoir=e,t.activeCriterion=!1},activateCriterionModal:function(t,e){t.activeModal=!0,t.activeComment=!1,t.activeChoir=!1,t.activeCriterion=e},activateChoirCriterionModal:function(t,e){t.activeModal=!0,t.activeComment=!1,t.activeChoir=e.choir,t.activeCriterion=e.criterion},deactivateModal:function(t){t.activeModal=!1},endModalProtection:function(t,e){t.protectModal=!1},activateChoir:function(t,e){t.activeChoir=e},activateCriterion:function(t,e){t.activeCriterion=e},updateChoirsList:function(t,e){t.choirsList=e},setScore:function(t,e){var i=t.scores.filter(function(t){return t.choir_id===e.choir_id}).filter(function(t){return t.criterion_id===e.criterion_id});1===i.length?i[0].raw_score=e.raw_score:t.scores.push(e)},setComment:function(t,e){for(var i in t.comments)if(t.comments[i].choir_id==e.choir_id)return void(t.comments[i].comment=e.comment);t.comments.push(e)},setSavingStatus:function(t,e){t.saving=Ct()({},t.saving,e)},setSavedStatus:function(t,e){t.saved=Ct()({},t.saved,e)},setErroredStatus:function(t,e){t.errored=Ct()({},t.errored,e)}},actions:{setScore:function(t,e){var i=Vt.state.choirsList.filter(function(t){return t.id===e.choir_id})[0],r=e.choir_id+"_"+e.caption_id+"_"+e.criterion_id;i&&(e.round_id=i.round_id,e.division_id=i.division_id),Vt.commit("setScore",e),Vt.commit("setSavingStatus",ft()({},r,!0)),Vt.commit("setSavedStatus",ft()({},r,!1)),Vt.commit("setErroredStatus",ft()({},r,!1)),zt(e,Vt)},setComment:function(t,e){Vt.commit("setComment",e),Ot(e)},saveRecording:function(t,e){Dt(e)}},getters:{captionWeightingId:function(t){return t.captionWeightingId},getCount:function(t){return t.count},getChoirsList:function(t){return t.choirsList.slice(0).sort(function(t,e){if(void 0===t.performance_order||void 0===t.performance_order)return t.name.localeCompare(e.name);var i=t.performance_order-e.performance_order;return 0===i?t.name.localeCompare(e.name):i})},getChoirScores:function(t){return function(e){return t.scores.filter(function(t){return t.choir_id===e})}},getChoirTotalScore:function(t,e){return function(t){var i=e.getChoirScores(t);return e.sumScores(i)}},getChoirTotalWeightedScore:function(t,e){return function(t){var i=e.getChoirScores(t);return e.sumWeightedScores(i)}},updateChoirsRanks:function(t,e){for(var i=t.choirsList,r=0;r<i.length;r++)i[r].total_score=e.getChoirTotalWeightedScore(i[r].id);i.sort(function(t,e){return e.total_score-t.total_score});for(var o=1,n=0;n<i.length;n++)i[n].rank=o,i[n].rank_tied=!1,(n>0&&i[n].total_score===i[n-1].total_score||n+1<i.length&&i[n].total_score===i[n+1].total_score)&&(i[n].rank_tied=!0),n+1<i.length&&i[n].total_score!==i[n+1].total_score&&o++;return i.sort(function(t,e){if(void 0===t.performance_order||void 0===t.performance_order)return t.name.localeCompare(e.name);var i=t.performance_order-e.performance_order;return 0===i?t.name.localeCompare(e.name):i})},getChoirRating:function(t,e){return function(i){var r=0===i?0:Math.round(i/e.maxScore*100),o=0,n="No Rating",c=!0,a=!1,s=void 0;try{for(var d,u=_t()(t.ratings);!(c=(d=u.next()).done);c=!0){var l=d.value;r>=l.min_score&&o<l.min_score&&(o=l.min_score,n=l.name)}}catch(t){a=!0,s=t}finally{try{!c&&u.return&&u.return()}finally{if(a)throw s}}return n+" ("+r+"%)"}},getChoirCaptionRank:function(t,e){return function(i,r){for(var o=t.choirsList,n=[],c=0;c<o.length;c++)n[c]={choir_id:o[c].id,caption_score:e.getChoirCaptionSubtotalScore(o[c].id,r)};n.sort(function(t,e){return e.caption_score-t.caption_score});for(var a=1,s=0;s<n.length;s++){if(n[s].rank=a,n[s].rank_tied=!1,(s>0&&n[s].caption_score===n[s-1].caption_score||s+1<n.length&&n[s].caption_score===n[s+1].caption_score)&&(n[s].rank_tied=!0),n[s].choir_id===i)return n[s];s+1<n.length&&n[s].caption_score!==n[s+1].caption_score&&a++}}},getChoirCaptionSubtotalScore:function(t,e){return function(t,i){var r=e.getChoirScores(t);return e.sumScores(r.filter(function(t){return t.caption_id===i}))}},sumScores:function(t){return function(t){return t.reduce(function(t,e){return t+e.raw_score},0)}},sumWeightedScores:function(t){return function(e){return e.reduce(function(e,i){var r=i.raw_score;return 1===t.captionWeightingId&&1===i.caption_id&&(r*=1.5),e+r},0)}},maxScore:function(t){for(var e=0,i=0;i<t.criteriaList.length;i++){var r=t.criteriaList[i].maxScore;1===t.captionWeightingId&&1===t.criteriaList[i].caption_id&&(r*=1.5),e+=r}return e},getCriterionScores:function(t){return function(e){return t.scores.filter(function(t){return t.criterion_id===e})}},activeCriterion:function(t){return t.activeCriterion},activeChoir:function(t){return t.activeChoir},activeChoirScores:function(t){return t.scores.filter(function(e){return e.choir_id===t.activeChoir.id})},activeCriterionScores:function(t){return t.scores.filter(function(e){return e.criterion_id===t.activeCriterion.id})},getChoirCriterionScore:function(t){return function(e,i){var r=t.scores.filter(function(t){return t.choir_id===e}).filter(function(t){return t.criterion_id===i});return 1===r.length?r[0].raw_score:null}},getChoirComment:function(t){return function(e){for(var i in t.comments)if(t.comments[i].choir_id==e)return t.comments[i].comment;return null}},getSavingStatus:function(t){return function(e){return void 0!==t.saving[e]&&t.saving[e]}},getSavedStatus:function(t){return function(e){return void 0!==t.saved[e]&&t.saved[e]}},getErroredStatus:function(t){return function(e){return void 0!==t.errored[e]&&t.errored[e]}}}});r.a.mixin({methods:{toOrdinal:function(t){if(parseFloat(t)===parseInt(t)&&!isNaN(t)){var e=["th","st","nd","rd"],i=t%100;return t+(e[(i-20)%10]||e[i]||e[0])}return t}}}),r.a.config.productionTip=!1,new r.a({el:"#app",store:Vt,components:{App:vt},template:"<App/>"})},"P/Gc":function(t,e){},P77S:function(t,e){},RtM3:function(t,e){},TFWe:function(t,e){},YfQ5:function(t,e){},"av/C":function(t,e){},edXu:function(t,e){},hzzq:function(t,e){},j5Ya:function(t,e){},kQIC:function(t,e){},mnaM:function(t,e){},ntvR:function(t,e){},pTcm:function(t,e){},vZP6:function(t,e){},xQCc:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.7629e94bf99f9b65d2cd.js.map